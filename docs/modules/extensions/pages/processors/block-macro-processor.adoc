= Block Macro Processor

BlockMacroProcessor is a SyntaxProcessor.

== DSL methods

include::page$processor.adoc[tag=syntaxproc]

`resolve_attributes`::
When called with `false`, sets the content_model to `:text`.

== Process method

`def process parent, target, attributes`

* parent is the enclosing block or document.
* target is the text between the `name::` and `[...]`
* attributes is a hash of the contents of `[...]` interpreted using positional_attributes and combined with default attributes.

== Example

Purpose::
Create a block macro named `gist` for embedding a gist.

=== sample-with-gist-macro.adoc

[source,asciidoc]
----
.My Gist
gist::123456[]
----

=== GistBlockMacro

[source,ruby]
----
require 'asciidoctor'
require 'asciidoctor/extensions'

class GistBlockMacro < Asciidoctor::Extensions::BlockMacroProcessor
  enable_dsl

  named :gist

  def process parent, target, attrs
    title_html = (attrs.has_key? 'title') ?
        %(<div class="title">#{attrs['title']}</div>\n) : nil

    html = %(<div class="openblock gist">
#{title_html}<div class="content">
<script src="https://gist.github.com/#{target}.js"></script>
</div>
</div>)

    create_pass_block parent, html, attrs, subs: nil
  end
end
----

== Usage

[source,ruby]
----
Asciidoctor::Extensions.register do
  block_macro GistBlockMacro if document.basebackend? 'html'
end

Asciidoctor.convert_file 'sample-with-gist.adoc', safe: :safe
----
