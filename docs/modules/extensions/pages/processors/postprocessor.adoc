= Postprocessor

PostProcessor is a DocumentProcessor

== Registration method

A PostProcessor is registered with `postprocessor`.

== DSL methods

include::page$processor.adoc[tag=docproc]

== Process method

`def process document, output`

The process method is called from a top-level Document after conversion.
Postprocessors are not called for subdocuments.
The document has been fully parsed and converted.
The result of conversion and previous Postprocessors is supplied in the `output` parameter as a string.

The `process` method should return the modified output string.

Note that the type of converter may be determined from document attributes, as seen in the example.

== Example

Purpose::
Insert copyright text in the footer.

== CopyrightFooterPostprocessor

[source,ruby]
----
class CopyrightFooterPostprocessor < Asciidoctor::Extensions::Postprocessor
  def process document, output
    content = (document.attr 'copyright') || 'Copyright Acme, Inc.'
    if document.basebackend? 'html'
      replacement = %(<div id="footer-text">\\1<br>\n#{content}\n</div>)
      output = output.sub(/<div id="footer-text">(.*?)<\/div>/m, replacement)
    elsif document.basebackend? 'docbook'
      replacement = %(<simpara>#{content}</simpara>\n\\1)
      output = output.sub(/(<\/(?:article|book)>)/, replacement)
    end
    output
  end
end
----

== Usage

[source,ruby]
----
Asciidoctor::Extensions.register do
  postprocessor CopyrightFooterPostprocessor
end

Asciidoctor.convert_file 'sample-with-copyright-footer.adoc', safe: :safe
----
